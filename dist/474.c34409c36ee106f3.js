"use strict";(self.webpackChunkemisora=self.webpackChunkemisora||[]).push([[474],{474:(L,g,s)=>{s.r(g),s.d(g,{LoginModule:()=>y});var c=s(6895),i=s(4006),t=s(4650),p=s(1436),f=s(529);let h=(()=>{class e{constructor(o){this.httpClient=o,this.urlBase=p.N.apiUrl}loginUser(o){return this.httpClient.post(`${this.urlBase}/user/login`,JSON.stringify({username:o.email,password:o.password}),{headers:{"Content-Type":"application/json"}})}getCustomerByIdPoint(o,n){return this.httpClient.get(`${this.urlBase}/customer?point_of_sale=${o}`,{headers:{"X-AUTH-TOKEN":n}})}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(f.eN))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})();var l=s(8869),u=s(4366),m=s(5602);function b(e,r){if(1&e){const o=t.EpF();t.TgZ(0,"ngb-alert",16),t.NdJ("closed",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.close())}),t._uU(1),t.qZA()}if(2&e){const o=t.oxw();t.Q6J("type",o.alerts.type),t.xp6(1),t.Oqu(o.alerts.message)}}let v=(()=>{class e{constructor(o,n,a){this._formBuilder=o,this.userLogin=n,this.router=a,this.isNextDisabled=!0,this.passwordVisible=!1,this.form=this._formBuilder.group({email:["",i.kI.compose([i.kI.required])],password:["",i.kI.compose([i.kI.required])]}),this.form.valueChanges.subscribe(d=>{this.isNextDisabled=!this.form.valid})}setDataLogin(){this.userLogin.loginUser(this.form.value).subscribe(o=>{this.alerts={},this.userLogin.getCustomerByIdPoint(o.payload.user_data.punto_de_venta,o.payload.token).subscribe(n=>{this.setSessionLogin(o.payload,n.payload)})},o=>{this.alerts={type:"danger",message:"El usuario o contrase\xf1a no es v\xe1lido."},setTimeout(()=>{this.alerts=!1},2e3)})}setSessionLogin(o,n){localStorage.setItem("token-session",btoa(o.token)),localStorage.setItem("user-session",btoa(JSON.stringify(o.user_data))),localStorage.setItem("point-of-sale",btoa(JSON.stringify(n))),this.router.navigateByUrl("/")}close(){this.alerts={}}togglePasswordVisibility(){this.passwordVisible=!this.passwordVisible}}return e.\u0275fac=function(o){return new(o||e)(t.Y36(i.qu),t.Y36(h),t.Y36(l.F0))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-login"]],decls:21,vars:4,consts:[[1,"page-login"],[1,"main-content"],[1,"content-form"],["class","alert-login",3,"type","closed",4,"ngIf"],[1,"h3","mb-3","font-weight-normal"],["novalidate","",1,"form-signin",3,"formGroup","ngSubmit"],[1,"form-field","user"],["for","inputEmail",1,"sr-only"],["type","email","id","inputEmail","required","","autofocus","","formControlName","email",1,"form-control"],[1,"form-field","password"],["for","inputPassword",1,"sr-only"],["id","inputPassword","required","","formControlName","password",1,"form-control",3,"type"],[1,"show-password",3,"click"],[1,"button-submit"],["type","submit",1,"btn-submit",3,"disabled"],[1,"image-found"],[1,"alert-login",3,"type","closed"]],template:function(o,n){1&o&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t.YNc(3,b,2,2,"ngb-alert",3),t.TgZ(4,"h3",4),t._uU(5,"Inicio de Sesi\xf3n"),t.qZA(),t.TgZ(6,"form",5),t.NdJ("ngSubmit",function(){return n.setDataLogin()}),t.TgZ(7,"div",6)(8,"label",7),t._uU(9,"Usuario"),t.qZA(),t._UZ(10,"input",8),t.qZA(),t.TgZ(11,"div",9)(12,"label",10),t._uU(13,"Contrase\xf1a"),t.qZA(),t._UZ(14,"input",11),t.TgZ(15,"mat-icon",12),t.NdJ("click",function(){return n.togglePasswordVisibility()}),t._uU(16,"visibility"),t.qZA()(),t.TgZ(17,"div",13)(18,"button",14),t._uU(19,"Ingresar"),t.qZA()()()(),t._UZ(20,"div",15),t.qZA()()),2&o&&(t.xp6(3),t.Q6J("ngIf",n.alerts),t.xp6(3),t.Q6J("formGroup",n.form),t.xp6(8),t.Q6J("type",n.passwordVisible?"text":"password"),t.xp6(4),t.Q6J("disabled",n.form.invalid||n.isNextDisabled))},dependencies:[c.O5,i._Y,i.Fj,i.JJ,i.JL,i.Q7,i.sg,i.u,u.Hw,m.xm],styles:[".page-login[_ngcontent-%COMP%]{height:100svh}.content-form[_ngcontent-%COMP%]{text-align:center}.main-content[_ngcontent-%COMP%]{display:flex;align-items:center}.main-content[_ngcontent-%COMP%]   .content-form[_ngcontent-%COMP%]{width:50%}.main-content[_ngcontent-%COMP%]   .content-form[_ngcontent-%COMP%]   .form-signin[_ngcontent-%COMP%]{padding:0 2rem;text-align:left;max-width:450px;margin:auto}.main-content[_ngcontent-%COMP%]   .image-found[_ngcontent-%COMP%]{width:50%;display:block;height:100%;background-image:url(login_bg.549c7d7e7c8e07f1.png);background-size:cover;background-position:center}.main-content[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block}.main-content[_ngcontent-%COMP%]   .form-field[_ngcontent-%COMP%]{margin-bottom:20px;position:relative}.main-content[_ngcontent-%COMP%]   .show-password[_ngcontent-%COMP%]{position:absolute;right:10px;bottom:10px;cursor:pointer}.alert-login[_ngcontent-%COMP%]{margin:1rem}"]}),e})(),C=(()=>{class e{constructor(o){this.router=o}canActivate(o,n){return this.isLoggedIn()}isLoggedIn(){return!localStorage.getItem("token-session")||this.router.navigateByUrl("/")}getLocalStorage(o){return localStorage.getItem(o)}}return e.\u0275fac=function(o){return new(o||e)(t.LFG(l.F0))},e.\u0275prov=t.Yz7({token:e,factory:e.\u0275fac,providedIn:"root"}),e})(),y=(()=>{class e{}return e.\u0275fac=function(o){return new(o||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[c.ez,l.Bz.forChild([{path:"",component:v,canActivate:[C]}]),i.UX,u.Ps,m._A]}),e})()}}]);